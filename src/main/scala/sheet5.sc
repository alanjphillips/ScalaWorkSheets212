// Do an immutable cache using a function or partial function